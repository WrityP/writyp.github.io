Array.prototype.random = function(){
	return this[Math.floor(Math.random()*this.length)];
}

rewards = {
	maxhealth:{
		name:"Heart-eater",
		path:"M371.148 21.422c-47.943.474-94.522 30.346-106.605 84.855 23.308 25.97 35.25 59.46 30.36 94.453l-18.51-2.585c6.01-43.03-18.18-83.975-60.573-106.483-30.015-13.248-62.242-15.24-91.802-8.28l-6.82 1.147c.035.21.058.394.093.603-.275.08-.552.152-.827.232.297.04.59.09.887.135 3.047 18.48 3.43 30.233 1.01 38.135-2.465 8.044-7.604 13.897-19.858 21.88l-10.947 7.13 10.287 8.056c21.587 16.905 26.17 33.387 22.36 44.382-3.81 10.995-17.38 20.564-42.932 20.02l-11.91-.254 2.59 11.627c3.902 17.518 2.97 29.854-.3 37.894s-8.532 12.52-16.617 15.308l.006.015-7.91 2.555C112.05 394.053 302.19 431.686 337.77 493.3c0-88.87 183.898-228.256 149.855-373.734-15.838-67.674-66.885-98.634-116.475-98.144zm-233.69 72.246c21.017 14.63 31.41 45.175 15.14 71.9 96.352-16.05 73.76 120.85 5.703 101.38-19.06 41.176-62.37 43.628-87.2 32.82 5.938-4.656 10.792-10.806 13.863-18.36 4.23-10.4 5.16-23.078 3.094-37.998 25.026-2.268 43.544-14.152 49.802-32.21 6.223-17.957-.74-38.94-19.358-57.192 8.663-7.18 14.733-15.126 17.727-24.897 3.145-10.27 3.022-21.51 1.227-35.442z",
		fill:'red',
		bonus_type:"max_hp",
		bonus_score:"5",
		description:"You devour your opponent's heart and feel their lifeforce pulsing through your flesh."
	},
	damage:{
		name:"Scavenger",
		path:"M262.406 17.188c-27.22 8.822-54.017 28.012-72.375 55.53 17.544 47.898 17.544 57.26 0 105.157 19.92 15.463 40.304 24.76 60.782 27.47-2.063-25.563-3.63-51.13 1.125-76.69-13.625-1.483-23.374-5.995-37-13.874V82.563c35.866 19.096 61.84 18.777 98.813 0v32.22c-13.364 6.497-21.886 11.16-35.25 13.218 3.614 25.568 3.48 51.15 1.375 76.72 18.644-3.265 37.236-12.113 55.5-26.845-14.353-47.897-14.355-57.26 0-105.156-16.982-28.008-47.453-46.633-72.97-55.532zm-129.594 8.218c-25.906 110.414-27.35 215.33-27.4 330.922-18.84-1.537-37.582-5.12-56.027-11.12v28.554h69.066c8.715 35.025 6.472 70.052-1.036 105.078h28.13c-7.195-35.026-8.237-70.053-.872-105.078h68.904v-28.555c-18.49 4.942-37.256 8.552-56.097 10.46.082-114.94 2.496-223.068-24.667-330.26zm89.47 202.375c0 117.27 25.517 233.342 120.155 257.97C446.62 464.716 462.72 345.374 462.72 227.78H222.28z",
		fill:'gold',
		bonus_type:"damage",
		bonus_score:"1",
		description:"They won't need their weapons anymore, you, on the other hand, have more killing to do."
	}
};

reward_keys = Object.keys(rewards);

player_type = {
	name:"Player",
	behaviors:[],
	hp:20,
	description:"You enter the blood-soaked circle of sand.",
	damage:0
}

behaviors = {
	enraged:{
		actions:[['attack'],['attack'],['attack']],
		path:'M256 51c-1.216 1.157-3.235 3.694-5.595 7.47-4.552 7.283-10.594 19.233-18.383 34.8v9.94c6.19 4.752 14.906 7.626 23.978 7.626 9.072 0 17.787-2.874 23.978-7.627v-9.94c-7.79-15.567-13.83-27.517-18.383-34.8-2.36-3.776-4.38-6.313-5.595-7.47zm-42.743 54.286c-28.17 6.895-55.87 20.62-82.175 41.132-16.04 80.706-31.2 175.83-16.89 254.565 6.188 2.322 12.687 4.44 19.403 6.398l-3.062-12.257-4.305-6.455 7.807-5.204c6.304-4.203 13.54-7.85 21.487-10.99-5.028-6.777-8.326-15.44-11.545-24.286-5.46-15.013-9.66-31.84-13.654-44.028l-9.792-29.87 24.565 19.616c24.47 19.543 49.132 32.704 82.918 56.314l10.07 7.037c5.944-.26 11.928-.39 17.917-.39 5.99 0 11.973.13 17.916.39l10.07-7.037c33.787-23.61 58.45-36.77 82.92-56.314l24.563-19.616-9.793 29.87c-3.995 12.19-8.193 29.015-13.654 44.028-3.22 8.847-6.517 17.51-11.545 24.287 7.948 3.138 15.183 6.786 21.487 10.99l7.807 5.203-4.305 6.455-3.062 12.258c6.716-1.956 13.215-4.075 19.402-6.397 14.31-78.736-.85-173.86-16.89-254.565-26.305-20.51-54.004-34.237-82.174-41.132v6.31l-2.75 2.746c-10.55 10.552-25.398 15.26-39.993 15.26-14.595 0-29.442-4.708-39.994-15.26l-2.75-2.746v-6.31zm75.98 55.876l13.39 13.145-6.572 6.695c-12.91 13.147-27.168 19.604-41.277 18.865-14.108-.74-26.793-8.077-38.39-18.442l-6.995-6.253 12.504-13.99 6.996 6.25c9.774 8.735 18.788 13.273 26.867 13.696 8.08.423 16.495-2.67 26.905-13.272l6.573-6.694zm-149.998 3.885c19.807 0 41.364 9.12 60.852 19.946 19.487 10.826 36.416 23.397 45.862 32.843l-13.268 13.267c-7.234-7.234-23.665-19.683-41.708-29.707-18.043-10.024-38.186-17.584-51.74-17.584v-18.765zm233.52 0v18.765c-13.552 0-33.695 7.56-51.738 17.584-18.043 10.024-34.474 22.473-41.708 29.707l-13.268-13.267c9.446-9.446 26.375-22.017 45.862-32.843 19.488-10.827 41.045-19.946 60.853-19.946zm-226.887 36.11c16.68 16.68 47.577 47.29 93.447 47.29v.316l16.757-24.214 16.603 24.475v-.578c45.87 0 76.767-30.61 93.447-47.29l13.268 13.266c-8.234 8.233-21.14 21.197-38.61 32.218 4.916 4.755 7.998 11.397 7.998 18.697 0 14.283-11.78 26.063-26.063 26.063-14.282 0-26.062-11.78-26.062-26.063 0-.183.01-.364.014-.546-3.9.798-7.922 1.415-12.06 1.828l28.074 41.386-3.79 5.315c-7.152 10.026-16.657 15.68-26.033 18.204-9.376 2.525-18.523 2.41-26.863 2.41s-17.496.107-26.944-2.4-19.065-8.05-26.67-17.95l-4.17-5.425 28.773-41.58c-4-.41-7.887-1.017-11.662-1.79.004.183.014.364.014.547 0 14.283-11.78 26.063-26.062 26.063-14.283 0-26.063-11.78-26.063-26.063 0-7.3 3.082-13.942 7.998-18.696-17.47-11.02-30.376-23.984-38.61-32.217l13.268-13.267zm-128.076 16.11c2.95 6.932 8.367 15.73 16.54 27.413 12.455 17.8 29.556 41.635 46.575 75.674 1.848 3.697 4.587 6.08 8.64 7.774.07-13.807.677-27.726 1.7-41.656l-24.876-21.55 12.286-14.184 14.638 12.68c.938-9.016 2.026-18.007 3.23-26.948-7.94-6.23-17.723-10.416-28.564-13.373-16.628-4.535-34.943-5.58-50.17-5.83zm476.406 0c-15.226.25-33.54 1.295-50.17 5.83-10.84 2.957-20.623 7.142-28.562 13.373 1.204 8.94 2.292 17.932 3.23 26.947l14.638-12.68 12.286 14.185-24.875 21.55c1.02 13.93 1.628 27.848 1.7 41.656 4.05-1.694 6.79-4.077 8.638-7.774 17.02-34.04 34.12-57.873 46.575-75.674 8.173-11.682 13.59-20.48 16.54-27.412zm-238.28 40.48L221.81 307.04c3.74 3.347 7.608 5.175 12.06 6.356 6.265 1.663 13.79 1.772 22.13 1.772s15.874-.117 21.982-1.762c4.345-1.17 8.01-2.94 11.476-6.216l-33.535-49.442zm-66.643.292c-4.142 0-7.298 3.155-7.298 7.297 0 4.14 3.156 7.297 7.298 7.297 4.14 0 7.297-3.156 7.297-7.297 0-4.142-3.156-7.298-7.297-7.298zm133.44 0c-4.14 0-7.297 3.155-7.297 7.297 0 4.14 3.156 7.297 7.297 7.297 4.142 0 7.298-3.156 7.298-7.297 0-4.142-3.156-7.298-7.298-7.298zm-166.322 67.34c1.684 5.604 3.355 11.28 5.214 16.392 4.053 11.14 9.25 19.18 12.498 22.424l27.458-9.153c-16.38-10.857-31.114-20.08-45.17-29.662zm199.204 0c-14.056 9.583-28.79 18.806-45.17 29.663l27.458 9.153c3.247-3.245 8.445-11.283 12.498-22.424 1.86-5.112 3.53-10.788 5.214-16.39zM256 375.634c-41.212 0-82.64 7.558-105.97 20.12l13.58 54.32c61.668 14.57 123.112 14.57 184.78 0l13.58-54.32c-23.33-12.562-64.758-20.12-105.97-20.12zm-.018 10.543c23.4-.08 46.826 4.167 70.074 13.005l8.77 3.334-6.67 17.542-8.77-3.336c-42.466-16.144-84.223-15.572-126.88.04l-8.814 3.226-6.448-17.623 8.81-3.223c23.152-8.473 46.527-12.883 69.928-12.964z',
		title:'Enraged',
		description:"This opponent seems to have lost all sense of self. Their only purpose is to put an end to your life.",
		fill:'red'
	},

	brave:{
		actions:[['parry','attack','attack'],['attack','attack','parry'],['parry','attack','attack']],
		path:'M105.7 41.16l-47.03 1.31 29.3 36.85L116 69.13zm300.6 0L396 69.14l28 10.2 29.3-36.86zm-278.4 8.18L139 79.87l-30.5 11.14L370.7 213.1l19.4-41.6zm256.2 0l-106.7 49.7 54.4 25.36 71.7-33.38L373 79.88zM180.2 144.3l-58.3 27.2 19.4 41.6 93.3-43.4zm241.1 2.8l-49.2 105.5 13 14.9 55.9-120zm-330.63.1l-19.6.4 55.83 119.8 12.9-14.8zm349.43 44.7l-30.6 65.6-34 84.7-55.8 33.3c-3.1 7.3-6.8 14-11.2 20C295.7 413.2 277 425 256 425s-39.7-11.8-52.5-29.5c-4.4-6.1-8.2-12.8-11.3-20.2l-55.1-33.2-27.9-70-37.13-79.7-29.5 19.4 45.5 151.8 81.23 97.1V487h174v-26.2l80.6-97.1 45.6-151.9zM256 249c-14.3 0-27.7 7.9-38 22.1-10.3 14.1-17 34.4-17 56.9s6.7 42.8 17 56.9c10.3 14.2 23.7 22.1 38 22.1s27.7-7.9 38-22.1c10.3-14.1 17-34.4 17-56.9s-6.7-42.8-17-56.9c-10.3-14.2-23.7-22.1-38-22.1z',
		title:'Brave',
		description:"This one think of himself as the hero of this story, their main purpose is to not seem like a coward.",
		fill:'gold'
	},

	poor:{
		actions:[['parry'],['attack'],['feint']],
		path:'M330.445 26.006l-126.79 211.61c24.586 20.357 46.073 33.117 68.584 38.63 22.632 5.543 47.123 4.26 78.421-4.044zM189.119 249.81C163.03 273.734 146 311.377 146 354.309c0 73.606 50.048 131.685 110 131.685s110-58.08 110-131.685c0-23.104-4.932-44.677-13.553-63.406-32.014 8.151-59.115 9.557-84.609 3.313-27.08-6.632-51.752-21.655-78.72-44.405zm47.507 88.622l5.851 17.553-49.345 16.448-5.85-17.552zm38.748 0l49.345 16.449-5.851 17.552-49.345-16.448zM256 411.977c19.532 0 38.348 9.842 55.886 27.38l-13.083 13.084c-15.358-15.358-29.438-21.964-42.803-21.964-13.365 0-27.445 6.606-42.803 21.964l-13.083-13.083c17.538-17.539 36.354-27.381 55.886-27.381z',
		title:'Poorly trained',
		description:"You sense that your adversary has left the training field too soon, they lack creativity.",
		fill:'green'
	},

	calculating:{
		actions:[['parry','parry','feint'],['feint','feint','parry'],['parry','parry','feint','attack']],
		path:'M254.1 18.63c-81.4 0-231.43 155.97-171.63 300.77 8 25.3 27.83 50.4 49.13 77.1 24.4 30.6 51.6 63.2 68.7 96.9h20.5c-18.1-39.8-48.5-75.9-74.6-108.6-27.4-34.3-48.73-65.2-48.73-87.9.1-9.1 2.23-18.1 5.53-26.3 23-61.4 114-119.7 148.5-135l3.6-2 3.9 1.3c60.9 20.9 129.3 66.7 154 135.7 4.1 11.7 5.9 18 5.6 27.3-.5 15.8-24.5 54.7-55 88.7-29.1 32.4-62.4 67.7-80 106.7h20.5c16.8-32.2 46.2-64 73.3-94.2 23.2-25.6 45.3-50 54.9-74.8 52.9-124-99.2-305.67-178.2-305.67zm.8 135.47c-38.7 21.5-85.1 52.2-113.7 88.2 9.7 83 59 146.1 118.3 146.1 59.2 0 108.3-62.7 118.2-145.3-28.9-42.1-78-72.9-122.8-89zm-58.3 83h2.4c13.1.1 26.1 2.7 39.1 7.4-16.8 40.6-59 42-78.1 0 12.2-4.8 24.4-7.2 36.6-7.4zm124.9 0c13-.1 26 2.3 39.1 7.4-19.2 42-61.3 40.6-78.2 0 13.1-4.7 26.1-7.3 39.1-7.4z',
		title:'Calculating',
		description:"Your opponent doesn't seem like the kind to act recklessly.",
		fill:'blue'
	},

	random:{
		actions:[['parry','attack','feint'],['parry','attack','feint'],['parry','attack','feint']],
		path:'M321.375 15.313L262.72 73.906l25.78 6.906-15.563 58.063c-5.44-.756-10.87-1.14-16.25-1.125-.887.003-1.77.04-2.656.063l21.97 45.75 42.25-28.407c-6.263-3.87-12.944-7.205-20.03-9.875l15.467-57.718 28.657 7.657-20.97-79.907zM133.25 40.063l-.094 82.906 23.125-13.345 30.064 52.063c-5.034 3.824-9.75 8.072-14.125 12.687l50.06 16.438 9.064-50.157c-7.797 1.777-15.372 4.336-22.594 7.625l-29.875-51.718 25.688-14.812-71.313-41.688zm255.28 90.593l13.345 23.094-52.063 30.063c-3.8-5.002-8.01-9.707-12.593-14.063l-16.126 48.156 49.28 8.938c-1.744-7.094-4.148-13.99-7.155-20.594l51.717-29.875 14.813 25.656 41.688-71.31-82.907-.064zm-290.78 38.5l-79.906 20.97 58.562 58.655L83.312 223l58.063 15.563c-.935 6.767-1.25 13.498-1 20.156l47.53-22.814-29.843-43.25c-4.022 6.432-7.466 13.31-10.218 20.625l-57.78-15.468 7.686-28.656zm275.875 81.28L328.5 272.813l28.313 42.125c3.15-5.2 5.937-10.673 8.28-16.437l57.938 15.53-6.905 25.783 80.063-21.532-58.72-58.092-7.687 28.656-57.592-15.438c1.27-7.706 1.707-15.387 1.437-22.97zm-230.28 30.283c1.5 6.44 3.516 12.72 6.06 18.78l-52.093 30.094L83.97 306.5l-41.376 71.813 82.594-.438-14.813-25.656 51.78-29.908c4.655 6.52 9.98 12.557 15.907 18.032l17.282-49.53-52-10.095zM294 316.75l-9.22 51.03c5.91-1.454 11.673-3.347 17.25-5.686l30.095 52.094L309 427.53l71.844 41.408-.438-82.625-25.687 14.843-29.876-51.75c6.437-4.588 12.43-9.847 17.844-15.687L294 316.75zM240.25 324l-44.125 30.03c5.32 3.262 10.955 6.127 16.875 8.533L197.47 420.5l-25.782-6.906 21.53 80.062 58.095-58.72-28.625-7.686 15.437-57.625c8.295 1.367 16.576 1.816 24.72 1.406L240.25 324z',
		title:'Chaotic',
		description:"There's no telling what this one will do next.",
		fill:'purple'
	},

	quick:{
		actions:[['parry','attack', 'feint', 'feint'],['parry','attack', 'feint', 'feint'],['parry','attack', 'feint', 'feint']],
		path:'M377.47 20.72l-16.283 9.186 22.844 40.47-114.405-10.25-13.03 14.812-4.47 27.5c-36.887 12.27-63.294 26.753-83.375 46.03-22.722 21.813-38.17 50.42-51.75 90.5l-31.25 3-12.844 14.595 2.53 106.062c-3.8 1.61-7.374 3.92-10.56 6.906-.12.113-.228.232-.345.345l-39-25.53L15.28 360l39.595 25.875c-3.366 11.778-.637 25.006 8.344 34.594 7.98 8.52 19.12 12.27 29.905 11.186l30.688-48.375c-.246-.212-.505-.41-.75-.624-1.62-4.136-4.03-8.03-7.25-11.47-2.524-2.693-5.36-4.913-8.407-6.655l8.78-79.124 90.658-.656c-8.33-27.148-2.43-56.865 18.562-76.53 13.287-12.448 30.203-18.614 47.563-18.907 6.4-.11 12.852.597 19.217 2.062l6.22-85.938 74.124-3.343c.967 7.163 4.09 14.104 9.408 19.78 3.314 3.54 7.157 6.263 11.312 8.157l.375.5 50.125-27.405c1.763-10.675-1.284-22.027-9.25-30.53-8.932-9.538-21.832-13.137-33.75-10.626l-23.28-41.25zm87.186 92.31l-75.125 41-4.81 25.626 31.624-16.406c30.88 48.452 54.04 102.334 74.062 158.438 12.075-66.802 1.912-127.814-22.812-185.032l23.062-11.97-26-11.655zm-191 94.876c-13.12.182-25.73 4.814-35.47 13.938-22.26 20.854-22.1 58.245 1.876 83.844 23.98 25.6 61.27 28.23 83.532 7.375 22.26-20.855 22.104-58.274-1.875-83.875-13.49-14.4-31.194-21.516-48.064-21.282zm-95.937 174.28l-33.282 3.408-41.907 66.125 10.907 31.06 15.063-23.56c54.545 27.254 113.684 40.662 179.75 33.124-53.016-22.93-103.78-48.64-149.063-81.156l18.532-29z',
		title:'Fast',
		description:"It's hard to keep up with this one, he keeps jumping back and forth.",
		fill:'grey'
	}
};

fighters_1 = {
	recruit:{
		behaviors:['poor','brave'],
		damage:0,
		hp:25,
		description:"A human recruit enters the arena almost hesitantly.",
		name:"recruit"
	},
	ork:{
		behaviors:['enraged','enraged','brave','random'],
		damage:2,
		hp:30,
		description:"The dumbest, meanest thing you've ever seen stumbles into the arena.",
		name:"ork"
	},
	goblin:{
		behaviors:['calculating','quick'],
		damage:0,
		hp:15,
		description:"The goblin scurries onto the sand, fidgetting with a couple of nasty-looking daggers.",
		name:"goblin"
	}
};

fighters_2 = {
	gladiator:{
		behaviors:['quick','random'],
		damage:1,
		hp:25,
		description:"Wearing leather armor and a broad sword, this woman could be mistaken for a mercenary, but you guess the arena makes her a gladiator.",
		name:"gladiator"
	},
	hobgoblin:{
		behaviors:['quick','calculating'],
		damage:1,
		hp:28,
		description:"The hobgoblin is larger than his hateful cousin but no less cunning.",
		name:"hobgoblin"
	},
	ogre:{
		behaviors:['random'],
		damage:3,
		hp:30,
		description:"With a frightful roar, the ogre slams his way through the gate of the arena.",
		name:"ogre"
	}
}

behavior_keys = Object.keys(behaviors);
fighters_1_keys = Object.keys(fighters_1);
fighters_2_keys = Object.keys(fighters_2);

defeat_path = "M220.09 25.297c-34.308 4.9-67.18 17.336-94.668 37.256l69.03 139.824-109.487-99.363c-28.304 39.302-42.5 93.27-31.61 163.675l15.22 94.37 70.474-13.275 3.458 18.365-15.444 2.91 44.65 127.653H197.2l-7.827-62.03 18.533-2.34 8.123 64.37h29.72V431.22h18.688v65.493h29.724l8.12-64.37 18.536 2.34-7.828 62.03h25.578l44.465-127.135-18.195-3.428 3.46-18.365 70.362 13.252 18.28-94.455c10.763-69.744-3.717-123.52-32.372-162.865l-108.713 98.66L384.36 63.613c-27.52-20.056-60.386-32.763-94.653-37.982l-34.52 164.485L220.09 25.297zm-92.182 192.266c4.232.063 8.63.81 13.186 2.208-7.603 6.918-12.375 16.89-12.375 27.978 0 20.887 16.93 37.816 37.813 37.816 15.928 0 29.548-9.85 35.12-23.793l29.136 22.365-81.8 26.383-.226.062c-15.9 4.26-30.327.71-40.15-7.498-9.82-8.21-15.218-20.12-17.12-32.207-1.902-12.086-.44-24.64 5.342-35.068 5.78-10.43 17.11-18.454 31.072-18.244zm216.53 16.656c-1.612 4.2-2.502 8.76-2.502 13.528 0 20.887 16.93 37.816 37.814 37.816s37.814-16.93 37.814-37.816c0-.565-.018-1.125-.043-1.684 2.2 7.927 2.488 16.48 1.177 24.81-1.902 12.087-7.3 24-17.12 32.208-9.823 8.21-24.248 11.76-40.15 7.498l-.226-.062-81.8-26.383 65.038-49.916zm-89.21 57.173l40.026 101.834-17.07 7.064-22.957-35.558-22.957 35.56-17.66-7.065 40.617-101.834z";
win_path = "M248.563 20.844c-43.486.112-87.294 4.423-131.563 13.843v53.97c93.527-27.524 193.554-20.19 277.844.75V34.968c-45.613-8.42-91.43-13.623-137.594-14.095-2.896-.03-5.788-.04-8.688-.03zm-3.657 68.5c-12.22.072-24.497.58-36.75 1.562V289.47c14.508-5.86 30.758-9.126 47.78-9.126 16.62 0 32.512 3.09 46.75 8.687l.002-196.936c-17.3-1.715-34.878-2.678-52.563-2.75-1.744-.007-3.473-.01-5.22 0zm-55.437 3.47c-14.55 1.76-29.064 4.18-43.407 7.436v180.72l33.156 25.467c3.22-2.642 6.652-5.084 10.25-7.375V92.813zm131.905 1.436v204.156c3.657 2.274 7.125 4.74 10.406 7.375l31.033-24.75V101.126c-13.522-2.72-27.365-5.028-41.438-6.875zm-65.438 204.78c-50.672 0-89.812 32.778-89.812 70.75 0 24.138 15.838 46.124 40.375 58.97l-17.406 60.156 17.937 5.188 12.47-43.03 24.53-.002v44.813h18.69v-44.813h25.06l12.47 43.032 17.938-5.188-16.813-58.156c26.797-12.478 44.344-35.544 44.344-60.97 0-37.972-39.11-70.75-89.783-70.75zm-55.343 41.033l44 48.406-52.063-6.94 8.064-41.467zm109.72 0l8.06 41.468-52.062 6.94 44-48.408zm-55.69 61.687l15.064 29.47h-30.125l15.062-29.47z";

player = {
	name:"Player",
	hp:10,
};

opponent = {
	name:"Opponent",
	hp:10
};

actions = {
	attack:{
		nullify:['feint'],
		damage:3,
		path:'M45.95 14.553c-19.38.81-30.594 11.357-30.282 30.283l19.768 30.78c4.43-1.213 9.36-3.838 14.248-7.335l42.474 59.935c-17.018 20.83-31.258 44.44-42.71 70.836l26.55 26.552c11.275-23.6 24.634-44.826 39.918-63.864l210.82 297.475 166.807 33.213L460.33 325.62 162.78 114.745c19.907-16.108 41.842-29.91 65.652-41.578l-26.553-26.55c-27.206 11.803-51.442 26.576-72.735 44.292L69.39 48.56c3.443-4.823 6.062-9.735 7.342-14.242l-30.78-19.765zm400.84 86.933v.008l.003-.008h-.002zm0 .008l-28.028 124.97-25.116-80.593-18.105 70.667-26.862-49.64-.584 57.818 128.484 91.69 15.184 87.017-1.168-186.885-34.457 39.713-9.346-154.756zm-300.95 27.98l222.224 196.368 25.645 66.75-66.75-25.645L130.6 144.734c4.91-5.278 9.995-10.36 15.238-15.26zm32.305 196.274v.004h.005l-.005-.004zm.005.004l28.028 22.775-36.21 4.088 57.82 19.272-105.706 4.09 115.05 27.45L136.1 422.114l127.316 25.696-67.164 43.803 208.494 1.752-87.017-15.185-104.54-150.676-35.037-1.752z'
	},
	feint:{
		nullify:['parry','feint'],
		damage:2,
		path:'M237.688 20.25L18.344 288.344l174.625 63.094c-8.217 8.152-18.068 15.154-29.876 20.78L276.5 399.282c-10.966 11.894-24.456 22.08-41 30.22l125.563 12.406c-16.877 21.158-38.8 38.795-67.063 52.03l204.688-29.623L412.5 273.125c-1.632 34.214-5.993 66.51-14.688 95.813L320 270.03c-1.03 21.615-3.57 42.188-8.438 61.22l-80.843-72.47c-1.363 11.97-3.38 23.5-6.25 34.408l-45.94-28.657L496.69 20.25h-90.75l-284.72 250.844 158.313 87.03-211.655-76.78L318.5 20.25h-80.813z'
	},
	parry:{
		nullify:['attack','parry'],
		damage:2,
		path:'M311.313 25.625l-23 10.656-29.532 123.032 60.814-111.968-8.28-21.72zM59.625 50.03c11.448 76.937 48.43 141.423 100.188 195.75 14.133-9.564 28.405-19.384 42.718-29.405-22.156-27.314-37.85-56.204-43.593-86.28-34.214-26.492-67.613-53.376-99.312-80.064zm390.47.032C419.178 76.1 386.64 102.33 353.31 128.22c-10.333 58.234-58.087 112.074-118.218 158.624-65.433 50.654-146.56 92.934-215.28 121.406l-.002 32.78c93.65-34.132 195.55-81.378 276.875-146.592C375.72 231.06 435.014 151.375 450.095 50.063zm-236.158 9.344l-8.5 27.813 40.688 73.06-6.875-85.31-25.313-15.564zm114.688 87.813C223.39 227.47 112.257 302.862 19.812 355.905V388c65.917-27.914 142.58-68.51 203.844-115.938 49.83-38.574 88.822-81.513 104.97-124.843zm-144.563 2.155c7.35 18.89 19.03 37.68 34 56.063 7.03-4.98 14.056-10.03 21.094-15.094-18.444-13.456-36.863-27.12-55.094-40.97zM352.656 269.72c-9.573 9.472-19.58 18.588-29.906 27.405 54.914 37.294 117.228 69.156 171.906 92.156V358.19c-43.86-24.988-92.103-55.13-142-88.47zm-44.906 39.81c-11.65 9.32-23.696 18.253-36.03 26.845C342.046 381.51 421.05 416.15 494.655 442.75v-33.22c-58.858-24.223-127.1-58.727-186.906-100zm-58.625 52.033l-46.188 78.25 7.813 23.593 27.75-11.344 10.625-90.5zm15.844.812L316.343 467l36.47 10.28-3.533-31.967-84.31-82.938z'
	}
}

action_keys = Object.keys(actions);

var initiate_actions = function(){
	$('#bottom_half').append(playerl.fighter.description+'<br/>');
	action_keys.forEach(function(e){
		$c = $('#models .model_svg').clone();
		$c.attr('id',e).find('path').css('fill','white').attr('d',actions[e].path);
		$("#player_screen .actions").append($c);
		console.log($c);
	});
}

var initiate_rewards = function(){
	reward_keys.forEach(function(e){
		$c = $('#models .model_svg').clone();
		$c.attr('id',e).css('border-color','red').find('path').css('fill','white').attr('d',rewards[e].path);
		$("#player_screen .rewards").append($c);
		console.log($c);
	});
}

var Character = function(id,fighter = player_type){
	this.id = id;
	this.fighter = fighter;
	this.damage = this.fighter.damage;
	this.behavior = behaviors[this.fighter.behaviors.random()];
	this.screen='#'+id+'_screen';
	this.max_hp=this.fighter.hp;
	this.hp=this.max_hp;
	this.updateHP();
	this.actions = [];
	this.clock = 0;
	this.level = 1;
}

Character.prototype.setBehavior = function(){
	$('#bottom_half').append(this.fighter.description+' ');
	$c = $('#models .model_svg').clone();
	$c.attr('id','opponent_behavior').find('path').css('fill',this.behavior.fill).attr('d',this.behavior.path);
	$("#opponent_screen .actions").html($c);
	$('#opponent_screen h1').html(this.behavior.title+" "+this.fighter.name);
	$('#bottom_half').append(this.behavior.description+"<br/>");
	console.log($c);
}

Character.prototype.updateHP = function(){
	if(this.hp<0){this.hp = 0;}
	newheight=Math.round(100-this.hp/this.max_hp*100)+"%";
	console.log(newheight);
	$(this.screen+" .health_bar div").css('height',newheight);
}

Character.prototype.setRandomActions = function(){
	this.actions = [];
	$('.opponent_action path').css('fill','black');
	for(i=0;i<3;i++){
		this.actions.push(action_keys[Math.floor(Math.random()*action_keys.length)]);
	}
	console.log(this.actions);
}

Character.prototype.setBehavioralActions = function(){
	this.actions = [];
	$('.opponent_action path').css('fill','black');
	for(i=0;i<3;i++){
		this.actions.push(this.behavior.actions[i].random());
	}
	console.log(this.actions);
}

Character.prototype.actAgainst = function(adversary){
	for(i=0;i<3;i++){
		console.log(this.actions[i]+" vs "+adversary.actions[i]);
		$('#'+adversary.id+i+' path').attr('d',actions[adversary.actions[i]].path);
		if(!actions[this.actions[i]].nullify.includes(adversary.actions[i]))
			{
				this.hp-=actions[adversary.actions[i]].damage+adversary.damage;
				$('#'+adversary.id+i+' path').css('fill','green');
			}
		else
			{
				$('#'+adversary.id+i+' path').css('fill','red');
			}
		if(!actions[adversary.actions[i]].nullify.includes(this.actions[i]))
			{
				adversary.hp-=actions[this.actions[i]].damage+this.damage;
				$('#'+this.id+i+' path').css('fill','green');
			}
		else
			{
				$('#'+this.id+i+' path').css('fill','red');
			}
	}
	this.updateHP();
	adversary.updateHP();
}

Character.prototype.setAction = function(action,adversary){
	if(this.hp<1 ||adversary.hp<1){return false;}
	console.log(this.clock+'!!!');
	if(this.clock == 0){
		adversary.setBehavioralActions();
		$('.player_action path').css('fill','black');
	}
	this.actions.push(action);
	$('#'+this.id+this.clock+' path').attr('d',actions[action].path).css('fill','white');
	this.clock++;
	if(this.clock == 3){
		this.actAgainst(adversary);
		this.actions = [];
		this.clock = 0;
	}
	if(this.hp<1){
		$('svg path').attr('d',defeat_path).css('fill','violet');
		$("#bottom_half").append("<span style='color:violet'>Your vision fades...</span>");
	}
	else if(adversary.hp<1){
		$('#middle_screen svg path').attr('d',win_path).css('fill','gold');
		if(this.level == 1){
			$("#bottom_half").append("<span style='color:green'>You have vanquished your foe!</span><br/>");
			$("#player_screen .actions").fadeOut(500);
			$("#player_screen .rewards").fadeIn(500);
		}
		else{
			$("#bottom_half").append("<span style='color:gold'>The crowd cheers as you are declared champion of the arena!</span><br/>");
		}
	}
};

Character.prototype.pickReward = function(reward){
	console.log('!!!');
	if(oppl.hp>0){return false;}
	$("#player_screen .actions").fadeIn(500);
	$("#player_screen .rewards").fadeOut(500);
	this[reward.bonus_type]+=Math.round(reward.bonus_score);
	this.hp = this.max_hp;
	this.level++;
	this.updateHP();
	$("#bottom_half").append(reward.description+"<br/>");
}

$(document).ready(function(){

	playerl = new Character('player');
	oppl = new Character('opponent',fighters_1[fighters_1_keys.random()]);
	initiate_actions();
	initiate_rewards();
	oppl.setBehavior();

	$('#player_screen .actions svg').on('click',function(){
		playerl.setAction($(this).attr('id'),oppl);
	});
	$('#player_screen .rewards svg').on('click',function(){
		playerl.pickReward(rewards[$(this).attr('id')]);
		oppl = new Character('opponent',fighters_2[fighters_2_keys.random()]);
		oppl.setBehavior();
	});
});